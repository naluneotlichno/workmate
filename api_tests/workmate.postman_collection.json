{
  "info": {
    "name": "Workmate API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:8080" },
    { "key": "taskId", "value": "" }
  ],
  "item": [
    {
      "name": "Create Task",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": { "mode": "raw", "raw": "{}" },
        "url": { "raw": "{{baseUrl}}/api/v1/tasks" }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "let id = '';",
              "try { const data = pm.response.json(); id = (data.task_id || data.id || '').toString(); } catch(e) {}",
              "if (id) { pm.collectionVariables.set('taskId', id); }",
              "pm.test('Task created (has task_id)', function () { pm.expect(id).to.be.a('string').and.not.empty; });"
            ]
          }
        }
      ]
    },
    {
      "name": "Add Files (valid)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"urls\": [\n    \"https://i.pinimg.com/736x/81/8f/d0/818fd0c7b9b0ebca8c753828bcb0a71b.jpg\",\n    \"https://psv4.userapi.com/s/v1/d2/A2XhIypFjc4NjEOaROKSCZXC9_2HLKIh4pXZL_3WAO6i9OssY_eB0TLPTvmHz6KJry7P8avuqSt1-M_I8hHZJMANGP3HWTsNXWOjNMmsK6vUA9q2ySQ8yyCSFsvNDAM-cq8gnefQFcTa/Rannetriasovye_amfibii_Vostochnoy_Evropy.pdf\",\n    \"https://psv4.userapi.com/s/v1/d2/o_HuRDUxdMzM8saNariRuufcOk_rbiezPUbTrS7aOdg4USCkaOw2oUTQ7Alle6CDRlXUdhOIAdRkHRAMgEfPbB-dcm39D9vZaXckmTvjkX84S9f1bFl_8xOO8Qs0ck2JDNvLV7Mm8BkK/Kak_slushat_muzyku_Max_Bazhenov.pdf\"\n  ]\n}"
        },
        "url": { "raw": "{{baseUrl}}/api/v1/tasks/{{taskId}}/files" }
      }
    },
    {
      "name": "Get Task Status",
      "request": {
        "method": "GET",
        "url": { "raw": "{{baseUrl}}/api/v1/tasks/{{taskId}}" }
      }
    },
    {
      "name": "Download Archive",
      "request": {
        "method": "GET",
        "url": { "raw": "{{baseUrl}}/api/v1/tasks/{{taskId}}/archive" }
      }
    },
    {
      "name": "Test Invalid Extension (expect 400)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"urls\": [\n    \"https://example.com/file.exe\",\n    \"https://example.com/document.txt\"\n  ]\n}"
        },
        "url": { "raw": "{{baseUrl}}/api/v1/tasks/{{taskId}}/files" }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Should be 400 Bad Request', function () { pm.response.to.have.status(400); });"
            ]
          }
        }
      ]
    },
    {
      "name": "Test Too Many Files (expect 400)",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"urls\": [\n    \"https://i.pinimg.com/736x/81/8f/d0/818fd0c7b9b0ebca8c753828bcb0a71b.jpg\",\n    \"https://psv4.userapi.com/s/v1/d2/A2XhIypFjc4NjEOaROKSCZXC9_2HLKIh4pXZL_3WAO6i9OssY_eB0TLPTvmHz6KJry7P8avuqSt1-M_I8hHZJMANGP3HWTsNXWOjNMmsK6vUA9q2ySQ8yyCSFsvNDAM-cq8gnefQFcTa/Rannetriasovye_amfibii_Vostochnoy_Evropy.pdf\",\n    \"https://psv4.userapi.com/s/v1/d2/o_HuRDUxdMzM8saNariRuufcOk_rbiezPUbTrS7aOdg4USCkaOw2oUTQ7Alle6CDRlXUdhOIAdRkHRAMgEfPbB-dcm39D9vZaXckmTvjkX84S9f1bFl_8xOO8Qs0ck2JDNvLV7Mm8BkK/Kak_slushat_muzyku_Max_Bazhenov.pdf\",\n    \"https://i.pinimg.com/550x/d3/8a/5f/d38a5f3c184afc0d71350b8d26d99b65.jpg\"\n  ]\n}"
        },
        "url": { "raw": "{{baseUrl}}/api/v1/tasks/{{taskId}}/files" }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test('Should be 400 Bad Request', function () { pm.response.to.have.status(400); });"
            ]
          }
        }
      ]
    }
  ]
}


